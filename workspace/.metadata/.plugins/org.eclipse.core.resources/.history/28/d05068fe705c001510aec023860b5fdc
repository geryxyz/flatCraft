package flatcraft;
import java.awt.EventQueue;
import java.lang.reflect.InvocationTargetException;
import java.util.Set;

import flatcraft.gui.MainWindowGui;
import flatcraft.worlds.*;

public class Game {
	
	public static MainWindowGui mainWindow;
	
	private World world;
	private Level level;
	
	public Game(Level level) {
		this.level = level;
	}

	public void start() {
		initGui();
		createWorld();	
	}
	
	private void initGui() {
		try {
			EventQueue.invokeAndWait(new Runnable() {
				public void run() {
					mainWindow = new MainWindowGui();
					mainWindow.setVisible(true);
				}
			});
		} catch (InvocationTargetException | InterruptedException e) {
			e.printStackTrace();
		}
	}
	
	private void createWorld() {
		int rows = MainWindowGui.BLOCK_ROWS;
		int cols = MainWindowGui.BLOCK_COLUMNS;
		
		switch(level) {
			case EMPTY:
				world = new EmptyWorld(rows, cols);
				break;
			case FLAT:
				world = new FlatWorld(rows, cols);
				break;
		}
	}

	public World getWorld() {
		return world;
	}
	
	public void waitAll() {
		Set<Thread> threadSet = Thread.getAllStackTraces().keySet();
		for(Thread t : threadSet) {
			try {
				Thread.sleep(500);
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
	}

}
